{"version":3,"sources":["./src/app/pages/qr-scanner/qr-scanner.page.html","./src/app/pages/qr-scanner/qr-scanner.module.ts","./src/app/pages/qr-scanner/qr-scanner-routing.module.ts","./src/app/pages/qr-scanner/qr-scanner.page.scss","./src/app/services/qrscan.service.ts","./src/app/pages/qr-scanner/qr-scanner.page.ts"],"names":[],"mappings":"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","file":"pages-qr-scanner-qr-scanner-module-es2015.js","sourcesContent":["export default \"<ion-header   class=\\\"ion-no-border\\\">\\n  <ion-toolbar> \\n    <ion-title  >\\n      QR Oku\\n    </ion-title>\\n    <ion-buttons slot=\\\"start\\\" (click)=\\\"back()\\\">\\n      <ion-icon name=\\\"chevron-back-outline\\\" ></ion-icon>\\n    </ion-buttons>\\n  </ion-toolbar> \\n</ion-header>\\n\\n<ion-content>\\n\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { QrScannerPageRoutingModule } from './qr-scanner-routing.module';\n\nimport { QrScannerPage } from './qr-scanner.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    QrScannerPageRoutingModule\n  ],\n  declarations: [QrScannerPage]\n})\nexport class QrScannerPageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { QrScannerPage } from './qr-scanner.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: QrScannerPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class QrScannerPageRoutingModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJxci1zY2FubmVyLnBhZ2Uuc2NzcyJ9 */\";","import { Injectable } from '@angular/core';\nimport { QRScanner, QRScannerStatus } from '@ionic-native/qr-scanner/ngx'; \nimport { Subject } from 'rxjs';\nimport { Platform } from '@ionic/angular';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class QrscanService {\n  scanSub: any; \n  channel_id: string;\n  message_id: string;\n  channel: any;\n\n  segments: Subject<string> = new Subject<string>();\n\n  constructor(\n    private qrScanner:QRScanner, ) { }\n\n  async qrScan(){\n\n      await this.qrScanner.prepare().then((status: QRScannerStatus) => { \n        if (status.authorized) {\n          this.qrScanner.show();\n          document.getElementsByTagName(\"body\")[0].style.opacity = \"0\";\n        } else if (status.denied) {\n          this.qrScanner.openSettings()\n        }\n      }).catch((e: any) => console.log('Error is', e));\n\n      this.scanSub = this.qrScanner.scan().subscribe((text: string) => {  \n        document.getElementsByTagName(\"body\")[0].style.opacity = \"1\"; \n        this.segments.next(text);\n      });\n  }\n\n  cancelQrScann(){ \n    this.scanSub.unsubscribe();\n    this.qrScanner.destroy() ;\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AlertController, LoadingController } from '@ionic/angular';\nimport { Channel } from 'src/app/objects/channel.model';\nimport { ChannelService } from 'src/app/services/channel.service'; \nimport { QrscanService } from 'src/app/services/qrscan.service';\nimport { Platform } from '@ionic/angular';\nimport { Location } from '@angular/common';\nimport { AuthService } from 'src/app/services/auth.service';\n\n@Component({\n  selector: 'app-qr-scanner',\n  templateUrl: './qr-scanner.page.html',\n  styleUrls: ['./qr-scanner.page.scss'],\n})\nexport class QrScannerPage implements OnInit {\n  cameraActive: boolean;\n  abonelik: any;\n  channel_id: string;\n  message_id: string;\n  channel: Channel;\n  backBtnSub: any;\n\n  constructor(\n    public location:Location,\n    private alertController:AlertController,\n    private qrscanservice:QrscanService,\n    private channelService:ChannelService, \n    private platform:Platform,\n    private loadingController:LoadingController, \n    public authService:AuthService,\n    public router: Router) { }\n\n  ngOnInit() {  \n    if(this.backBtnSub){\n      this.backBtnSub.unsubscribe();\n    }  \n    this.backBtnSub = this.platform.backButton.subscribe(() => {  \n      document.getElementsByTagName(\"body\")[0].style.opacity = \"1\";\n      this.cancelQrScann()\n    });\n    this.openCamera();\n  }\n\n  openCamera(){   \n    this.cameraActive = true\n    this.qrscanservice.qrScan()\n    if(this.abonelik){\n      this.abonelik.unsubscribe();\n    }\n    this.abonelik       = this.qrscanservice.segments.subscribe(async val=>{  \n      const url         = new URL(val);  \n      this.channel_id   = new URLSearchParams(url.search).get('c');\n      this.message_id   = new URLSearchParams(url.search).get('m');\n      this.cameraActive = false\n      this.qrscanservice.cancelQrScann();\n      this.getChannelInfo();\n    })\n  }\n\n  cancelQrScann(){\n    this.cameraActive = false\n    this.qrscanservice.cancelQrScann(); \n  }\n\n  async getChannelInfo(){\n    const loading = await this.loadingController.create({ \n      message: 'Please wait...',\n      duration:5000,\n    });\n    await loading.present(); \n    this.channelService.getChannelInfo(this.channel_id).get().subscribe(async (snapshot)=>{\n      loading.dismiss();\n      this.channel = <Channel>snapshot.data();\n      if(this.channel.registered_users_only){\n        if(!this.authService.USER){\n          const alert = await this.alertController.create({\n            cssClass: 'my-custom-class',\n            header  : 'Üyelik Gerekli',\n            message : 'Mesajı görebilmeniz için hesabınız olmalı',\n            buttons : [{\n                text: 'Okay',\n                handler: async () => {               \n                  this.router.navigate(['login']);\n                }\n              }\n            ]\n          });\n          await alert.present();\n          return;\n        }\n      }\n      if(this.channel.flash){\n        this.showFlashMessage()\n      }else{\n        this.router.navigate(['/channel-details/'+this.channel_id]); \n        //window.location.href = '/channel-details/'+this.channel_id\n      }\n    })\n  }\n  // TODO: Kanal barkodu oluşturulken. mesajı olmayan kanlda barkod dözükmüyor doğal olarak. Mesaj barkodu gibi kanal barkoduda oluşmalı.\n\n  showFlashMessage(){\n    if(this.channel.announce_type == 'text'){   \n      if(this.message_id){ \n        this.router.navigate(['/text/'+this.channel_id+'/'+this.message_id]);\n      }else{\n        this.router.navigate(['/board-messages/'+this.channel_id]);\n      }\n    }else if(this.channel.announce_type == 'brochure'){\n      if(this.message_id){ \n        this.router.navigate(['/brochure/'+this.channel_id+'/'+this.message_id]);\n      }else{\n        this.router.navigate(['/board-messages/'+this.channel_id]);\n      }\n    }else if(this.channel.announce_type == 'food_drink_menu'){\n      if(this.message_id){ \n        this.router.navigate(['/food-drink-menu/'+this.channel_id+'/'+this.message_id]);\n      }else{\n        this.router.navigate(['/board-messages/'+this.channel_id]);\n      }\n    }\n  }\n\n  back(){\n    this.location.back();\n  }\n \n\n}\n"],"sourceRoot":"webpack:///"}