{"version":3,"sources":["webpack:///src/app/pages/qr-scanner/qr-scanner.page.html","webpack:///src/app/pages/qr-scanner/qr-scanner.module.ts","webpack:///src/app/pages/qr-scanner/qr-scanner-routing.module.ts","webpack:///src/app/pages/qr-scanner/qr-scanner.page.scss","webpack:///src/app/services/qrscan.service.ts","webpack:///src/app/pages/qr-scanner/qr-scanner.page.ts"],"names":["QrScannerPageModule","imports","declarations","routes","path","component","QrScannerPageRoutingModule","forChild","exports","QrscanService","qrScanner","segments","prepare","then","status","authorized","show","document","getElementsByTagName","style","opacity","denied","openSettings","e","console","log","scanSub","scan","subscribe","text","next","unsubscribe","destroy","providedIn","QrScannerPage","location","alertController","qrscanservice","channelService","platform","loadingController","authService","router","backBtnSub","backButton","cancelQrScann","openCamera","cameraActive","qrScan","abonelik","val","url","URL","channel_id","URLSearchParams","search","get","message_id","getChannelInfo","create","message","duration","loading","present","snapshot","dismiss","channel","data","registered_users_only","USER","cssClass","header","buttons","handler","navigate","alert","flash","showFlashMessage","announce_type","back","selector","template"],"mappings":"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","file":"pages-qr-scanner-qr-scanner-module-es5.js","sourcesContent":["export default \"<ion-header   class=\\\"ion-no-border\\\">\\n  <ion-toolbar> \\n    <ion-title  >\\n      QR Oku\\n    </ion-title>\\n    <ion-buttons slot=\\\"start\\\" (click)=\\\"back()\\\">\\n      <ion-icon name=\\\"chevron-back-outline\\\" ></ion-icon>\\n    </ion-buttons>\\n  </ion-toolbar> \\n</ion-header>\\n\\n<ion-content>\\n\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { QrScannerPageRoutingModule } from './qr-scanner-routing.module';\n\nimport { QrScannerPage } from './qr-scanner.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    QrScannerPageRoutingModule\n  ],\n  declarations: [QrScannerPage]\n})\nexport class QrScannerPageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { QrScannerPage } from './qr-scanner.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: QrScannerPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class QrScannerPageRoutingModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJxci1zY2FubmVyLnBhZ2Uuc2NzcyJ9 */\";","import { Injectable } from '@angular/core';\nimport { QRScanner, QRScannerStatus } from '@ionic-native/qr-scanner/ngx'; \nimport { Subject } from 'rxjs';\nimport { Platform } from '@ionic/angular';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class QrscanService {\n  scanSub: any; \n  channel_id: string;\n  message_id: string;\n  channel: any;\n\n  segments: Subject<string> = new Subject<string>();\n\n  constructor(\n    private qrScanner:QRScanner, ) { }\n\n  async qrScan(){\n\n      await this.qrScanner.prepare().then((status: QRScannerStatus) => { \n        if (status.authorized) {\n          this.qrScanner.show();\n          document.getElementsByTagName(\"body\")[0].style.opacity = \"0\";\n        } else if (status.denied) {\n          this.qrScanner.openSettings()\n        }\n      }).catch((e: any) => console.log('Error is', e));\n\n      this.scanSub = this.qrScanner.scan().subscribe((text: string) => {  \n        document.getElementsByTagName(\"body\")[0].style.opacity = \"1\"; \n        this.segments.next(text);\n      });\n  }\n\n  cancelQrScann(){ \n    this.scanSub.unsubscribe();\n    this.qrScanner.destroy() ;\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AlertController, LoadingController } from '@ionic/angular';\nimport { Channel } from 'src/app/objects/channel.model';\nimport { ChannelService } from 'src/app/services/channel.service'; \nimport { QrscanService } from 'src/app/services/qrscan.service';\nimport { Platform } from '@ionic/angular';\nimport { Location } from '@angular/common';\nimport { AuthService } from 'src/app/services/auth.service';\n\n@Component({\n  selector: 'app-qr-scanner',\n  templateUrl: './qr-scanner.page.html',\n  styleUrls: ['./qr-scanner.page.scss'],\n})\nexport class QrScannerPage implements OnInit {\n  cameraActive: boolean;\n  abonelik: any;\n  channel_id: string;\n  message_id: string;\n  channel: Channel;\n  backBtnSub: any;\n\n  constructor(\n    public location:Location,\n    private alertController:AlertController,\n    private qrscanservice:QrscanService,\n    private channelService:ChannelService, \n    private platform:Platform,\n    private loadingController:LoadingController, \n    public authService:AuthService,\n    public router: Router) { }\n\n  ngOnInit() {  \n    if(this.backBtnSub){\n      this.backBtnSub.unsubscribe();\n    }  \n    this.backBtnSub = this.platform.backButton.subscribe(() => {  \n      document.getElementsByTagName(\"body\")[0].style.opacity = \"1\";\n      this.cancelQrScann()\n    });\n    this.openCamera();\n  }\n\n  openCamera(){   \n    this.cameraActive = true\n    this.qrscanservice.qrScan()\n    if(this.abonelik){\n      this.abonelik.unsubscribe();\n    }\n    this.abonelik       = this.qrscanservice.segments.subscribe(async val=>{  \n      const url         = new URL(val);  \n      this.channel_id   = new URLSearchParams(url.search).get('c');\n      this.message_id   = new URLSearchParams(url.search).get('m');\n      this.cameraActive = false\n      this.qrscanservice.cancelQrScann();\n      this.getChannelInfo();\n    })\n  }\n\n  cancelQrScann(){\n    this.cameraActive = false\n    this.qrscanservice.cancelQrScann(); \n  }\n\n  async getChannelInfo(){\n    const loading = await this.loadingController.create({ \n      message: 'Please wait...',\n      duration:5000,\n    });\n    await loading.present(); \n    this.channelService.getChannelInfo(this.channel_id).get().subscribe(async (snapshot)=>{\n      loading.dismiss();\n      this.channel = <Channel>snapshot.data();\n      if(this.channel.registered_users_only){\n        if(!this.authService.USER){\n          const alert = await this.alertController.create({\n            cssClass: 'my-custom-class',\n            header  : 'Üyelik Gerekli',\n            message : 'Mesajı görebilmeniz için hesabınız olmalı',\n            buttons : [{\n                text: 'Okay',\n                handler: async () => {               \n                  this.router.navigate(['login']);\n                }\n              }\n            ]\n          });\n          await alert.present();\n          return;\n        }\n      }\n      if(this.channel.flash){\n        this.showFlashMessage()\n      }else{\n        this.router.navigate(['/channel-details/'+this.channel_id]); \n        //window.location.href = '/channel-details/'+this.channel_id\n      }\n    })\n  }\n  // TODO: Kanal barkodu oluşturulken. mesajı olmayan kanlda barkod dözükmüyor doğal olarak. Mesaj barkodu gibi kanal barkoduda oluşmalı.\n\n  showFlashMessage(){\n    if(this.channel.announce_type == 'text'){   \n      if(this.message_id){ \n        this.router.navigate(['/text/'+this.channel_id+'/'+this.message_id]);\n      }else{\n        this.router.navigate(['/board-messages/'+this.channel_id]);\n      }\n    }else if(this.channel.announce_type == 'brochure'){\n      if(this.message_id){ \n        this.router.navigate(['/brochure/'+this.channel_id+'/'+this.message_id]);\n      }else{\n        this.router.navigate(['/board-messages/'+this.channel_id]);\n      }\n    }else if(this.channel.announce_type == 'food_drink_menu'){\n      if(this.message_id){ \n        this.router.navigate(['/food-drink-menu/'+this.channel_id+'/'+this.message_id]);\n      }else{\n        this.router.navigate(['/board-messages/'+this.channel_id]);\n      }\n    }\n  }\n\n  back(){\n    this.location.back();\n  }\n \n\n}\n"]}